<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Native C/C++ API | NitrosBase</title>
    <meta name="description" content="">
    
    
    <link rel="preload" href="/assets/css/0.styles.154cb869.css" as="style"><link rel="preload" href="/assets/js/app.baeb26dc.js" as="script"><link rel="preload" href="/assets/js/2.8e020b7e.js" as="script"><link rel="preload" href="/assets/js/9.5eb39887.js" as="script"><link rel="prefetch" href="/assets/js/10.e1943148.js"><link rel="prefetch" href="/assets/js/11.e73b5ac5.js"><link rel="prefetch" href="/assets/js/12.7bfa7f61.js"><link rel="prefetch" href="/assets/js/13.3a9eb135.js"><link rel="prefetch" href="/assets/js/14.eebeb3e5.js"><link rel="prefetch" href="/assets/js/15.05524356.js"><link rel="prefetch" href="/assets/js/16.e24545f3.js"><link rel="prefetch" href="/assets/js/17.19d25572.js"><link rel="prefetch" href="/assets/js/18.6991e38c.js"><link rel="prefetch" href="/assets/js/3.9e4cd4b4.js"><link rel="prefetch" href="/assets/js/4.dd0e05cf.js"><link rel="prefetch" href="/assets/js/5.8899250e.js"><link rel="prefetch" href="/assets/js/6.b6c99375.js"><link rel="prefetch" href="/assets/js/7.348434a9.js"><link rel="prefetch" href="/assets/js/8.f8ee1f78.js">
    <link rel="stylesheet" href="/assets/css/0.styles.154cb869.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">NitrosBase</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><!---->  <ul class="sidebar-links"><li><a href="/" class="sidebar-link">NitrosBase 2.0</a></li><li><a href="/ustanovka-i-administrirovanie.html" class="sidebar-link">Установка и администрирование</a></li><li><a href="/demonstracionnaya-baza-dannykh.html" class="sidebar-link">Демонстрационная база данных</a></li><li><a href="/multimodelnost.html" class="sidebar-link">Мультимодельность</a></li><li><a href="/sql.html" class="sidebar-link">SQL</a></li><li><a href="/graph-it.html" class="sidebar-link">Graph-IT</a></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading open"><span>API</span> <span class="arrow down"></span></p> <ul class="sidebar-group-items"><li><a href="/c-api.html" class="active sidebar-link">Native C/C++ API</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/c-api.html#nb-connect" class="sidebar-link">nb_connect</a></li><li class="sidebar-sub-header"><a href="/c-api.html#nb-disconnect" class="sidebar-link">nb_disconnect</a></li><li class="sidebar-sub-header"><a href="/c-api.html#nb-setoption" class="sidebar-link">nb_setoption</a></li><li class="sidebar-sub-header"><a href="/c-api.html#nb-errno" class="sidebar-link">nb_errno</a></li><li class="sidebar-sub-header"><a href="/c-api.html#nb-err-text" class="sidebar-link">nb_err_text</a></li><li class="sidebar-sub-header"><a href="/c-api.html#nb-execute-sql" class="sidebar-link">nb_execute_sql</a></li><li class="sidebar-sub-header"><a href="/c-api.html#nb-fetch-row" class="sidebar-link">nb_fetch_row</a></li><li class="sidebar-sub-header"><a href="/c-api.html#nb-field-count" class="sidebar-link">nb_field_count</a></li><li class="sidebar-sub-header"><a href="/c-api.html#nb-field-name" class="sidebar-link">nb_field_name</a></li><li class="sidebar-sub-header"><a href="/c-api.html#nb-field-type" class="sidebar-link">nb_field_type</a></li><li class="sidebar-sub-header"><a href="/c-api.html#nb-field-value" class="sidebar-link">nb_field_value</a></li><li class="sidebar-sub-header"><a href="/c-api.html#создание-кnиентского-приnожения" class="sidebar-link">Создание клиентского приложения</a></li></ul></li><li><a href="/dotnet-api.html" class="sidebar-link">.NET API</a></li><li><a href="/odbc.html" class="sidebar-link">ODBC</a></li></ul></div></li><li><a href="/log.html" class="sidebar-link">Версии</a></li></ul> </div> <div class="page"> <div class="content default"><h1 id="native-c-c-api"><a href="#native-c-c-api" aria-hidden="true" class="header-anchor">#</a> Native C/C++ API</h1> <p>C API следует практикам, используемым в драйверах других популярных СУБД.</p> <p>Типовая сессия работы с СУБД имеет следующий сценарий:</p> <ul><li>соединение с сервером</li> <li>запрос на сервер</li> <li>получение ответа</li> <li>отсоединение от сервера</li></ul> <p>При успешном соединении с сервером в вызывающий контекст возвращается дескриптор соединения, однозначно идентифицирующий клиентскую сессию. Этот дескриптор в дальнейшем используется во всех вызовах API.</p> <p>При использовании API следует избегать использования «сырых» типов и числовых значений, не обернутых в константы и typedef’ы. На различных платформах определяемые в C API значения констант и макросов, а также нижележащих типов могут отличаться. Кроме того, они могут изменяться с изменением версий API.</p> <h2 id="nb-connect"><a href="#nb-connect" aria-hidden="true" class="header-anchor">#</a> nb_connect</h2> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token class-name">NB_HANDLE</span> nb_connect <span class="token punctuation">(</span>
    <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span> host<span class="token punctuation">,</span>
    <span class="token keyword">int</span> sockport<span class="token punctuation">,</span>
    <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span> user<span class="token punctuation">,</span>
    <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span> password
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Предпринимает попытку соединения с сервером NitrosBase.</p> <p>Параметры:</p> <ul><li>host — имя узла сервера NitrosBase</li> <li>sockport — TCP-порт сервера NitrosBase</li> <li>user — пользователь сервера NitrosBase</li> <li>password — пароль пользователя сервера NitrosBase</li></ul> <p>Возвращаемое значение:</p> <ul><li>В случае успеха — дескриптор соединения</li> <li>В случае неудачи — NB_INVALID_HANDLE</li></ul> <p>В настоящее время NitrosBase не поддерживает аутентификацию. Параметры user, password зарезервированы — можно передавать любые значения, в том числе NULL.</p> <h2 id="nb-disconnect"><a href="#nb-disconnect" aria-hidden="true" class="header-anchor">#</a> nb_disconnect</h2> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token class-name">NB_ERROR_T</span> nb_disconnect <span class="token punctuation">(</span>
    <span class="token class-name">NB_HANDLE</span> connection
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Завершает соединение с сервером NitrosBase.</p> <p>Параметры:</p> <ul><li>connection — дескриптор соединения с сервером</li></ul> <p>Возвращаемое значение:</p> <ul><li>NB_SUCCESS в случае успеха</li> <li>код ошибки в случае неудачи</li></ul> <h2 id="nb-setoption"><a href="#nb-setoption" aria-hidden="true" class="header-anchor">#</a> nb_setoption</h2> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">void</span> nb_setoption <span class="token punctuation">(</span>
    <span class="token class-name">NB_HANDLE</span> connection<span class="token punctuation">,</span>
    <span class="token class-name">NB_CONN_OPTIONS</span> option<span class="token punctuation">,</span>
    <span class="token keyword">int</span> <span class="token keyword">value</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Используется для настройки параметров соединения с сервером.</p> <p>Параметры функции:</p> <ul><li>connection — дескриптор соединения</li> <li>option — параметр соединения, который следует настроить</li> <li>value — новое значение параметра соединения: булев параметр 0 или 1 (параметров других типов в текущей версии драйвера и СУБД нет).</li></ul> <p>NB_CONN_OPTIONS — перечисление, которое содержит следующие значения:</p> <ul><li>NB_OPT_STREAMED_RESULT — сервер отдает ответ, не дожидаясь получения полного результирующего набора (работает нестабильно). В этом режиме функция NBAffectedRows() недоступна: всегда возвращает 0 и выставляет errno</li> <li>NB_OPT_ERROR_EXCEPTION — ошибка генерирует исключение</li> <li>NB_OPT_DATETIME_MICROSECONDS — получение значений типа дата-время с точностью до микросекунды (1), или с точностью до миллисекунды (0).</li></ul> <h2 id="nb-errno"><a href="#nb-errno" aria-hidden="true" class="header-anchor">#</a> nb_errno</h2> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token class-name">NB_ERROR_T</span> nb_errno <span class="token punctuation">(</span>
    <span class="token class-name">NB_HANDLE</span> connection
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Возвращает код последней ошибки, ассоциированной с соединением.</p> <p>Параметры:</p> <ul><li>connection — дескриптор соединения с сервером</li></ul> <p>Возвращаемое значение:</p> <ul><li>NB_SUCCESS — успех</li> <li>NB_ERROR_UNKNOWN = (NB_ERROR | 0) —  общая ошибка</li> <li>NB_ERROR_NOT_IMPLEMENTED = (NB_ERROR | 1) — функциональность не реализована</li> <li>NB_ERROR_UNEXPECTED = (NB_ERROR | 2) — неожиданный результат; при выполнении функции возникло непредусмотренное состояние</li> <li>NB_ERROR_ARGUMENTS = (NB_ERROR | 3) — некорректное сочетание значений аргументов функции</li> <li>NB_ERROR_TIMEOUT = (NB_ERROR | 4) — таймаут при выполнении функции</li> <li>NB_ERROR_NO_DATA = (NB_ERROR | 5) — нет данных при ответе на запрос</li></ul> <h2 id="nb-err-text"><a href="#nb-err-text" aria-hidden="true" class="header-anchor">#</a> nb_err_text</h2> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span> nb_err_text <span class="token punctuation">(</span>
    <span class="token class-name">NB_HANDLE</span> connection
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Возвращает текст ошибки, ассоциированной с соединением.</p> <p>Параметры:</p> <ul><li>connection — дескриптор соединения с сервером</li></ul> <p>Возвращаемое значение — текст ошибки.</p> <h2 id="nb-execute-sql"><a href="#nb-execute-sql" aria-hidden="true" class="header-anchor">#</a> nb_execute_sql</h2> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token class-name">NB_ERROR_T</span> nb_execute_sql <span class="token punctuation">(</span>
    <span class="token class-name">NB_HANDLE</span> connection<span class="token punctuation">,</span>
    <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span> query<span class="token punctuation">,</span>
    size_t length
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Выполняет SQL-запрос на сервере.</p> <p>Параметры:</p> <ul><li>connection — дескриптор соединения с сервером</li> <li>query — текст запроса</li> <li>length — длина текста запроса</li></ul> <p>Возвращаемое значение:</p> <ul><li>NB_SUCCESS в случае успеха</li> <li>Код ошибки в случае неудачи.</li></ul> <p>Несмотря на название, функция может выполнять не только SQL-запросы, но также, к примеру, запросы на SPARQL и других поддерживаемых сервером языках запросов.</p> <p>Параметр length используется в случае, если в тексте запроса встречаются бинарные данные (к примеру, символ \0).</p> <h2 id="nb-fetch-row"><a href="#nb-fetch-row" aria-hidden="true" class="header-anchor">#</a> nb_fetch_row</h2> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token class-name">NB_ERROR_T</span> nb_fetch_row <span class="token punctuation">(</span>
    <span class="token class-name">NB_HANDLE</span> connection
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Получение следующей записи из результирующего набора данных, который сервер вернул в ответ на запрос.</p> <p>Параметры:</p> <ul><li>connection — дескриптор соединения с сервером</li></ul> <p>Возвращаемое значение:</p> <ul><li>NB_SUCCESS в случае удачи</li> <li>Код ошибки в случае неуспеха.</li></ul> <h2 id="nb-field-count"><a href="#nb-field-count" aria-hidden="true" class="header-anchor">#</a> nb_field_count</h2> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">int</span> nb_field_count <span class="token punctuation">(</span>
    <span class="token class-name">NB_HANDLE</span> connection
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Возвращает число полей в последней полученной с помощью nb_fetch_row записи.</p> <p>Параметры:</p> <ul><li>connection — дескриптор соединения с сервером</li></ul> <p>Возвращаемое значение:</p> <ul><li>Число полей в случае успеха</li> <li>-1 в случае неудачи</li></ul> <p>Число полей в результирующем наборе — не константная величина, и может отличаться от записи к записи. В графовой модели данных у различных узлов графа число полей может отличаться.</p> <h2 id="nb-field-name"><a href="#nb-field-name" aria-hidden="true" class="header-anchor">#</a> nb_field_name</h2> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token class-name">NB_ERROR_T</span> nb_field_name <span class="token punctuation">(</span>
    <span class="token class-name">NB_HANDLE</span> connection<span class="token punctuation">,</span>
    <span class="token keyword">int</span> fieldnum<span class="token punctuation">,</span> NBValue <span class="token operator">*</span> name
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Возвращает имя поля в записи, полученной последним вызовом nb_fetch_row.</p> <p>Параметры:</p> <ul><li>connection — дескриптор соединения с сервером</li> <li>fieldnum — номер поля, начиная с 0</li> <li>name — указатель на структуру NBValue, в которую будет передан результат</li></ul> <p>Структура NBValue определена следующим образом:</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">struct</span> NBValue <span class="token punctuation">{</span>
 <span class="token class-name">NB_DATA_TYPE</span> type<span class="token punctuation">;</span>
 union <span class="token punctuation">{</span>
     <span class="token keyword">int</span> intv<span class="token punctuation">;</span>
     <span class="token keyword">long</span> <span class="token keyword">long</span> int64v<span class="token punctuation">;</span>
     <span class="token keyword">double</span> dbl<span class="token punctuation">;</span>
     <span class="token keyword">struct</span> <span class="token punctuation">{</span>
         <span class="token keyword">char</span> <span class="token operator">*</span>str<span class="token punctuation">;</span>
         <span class="token keyword">int</span> len<span class="token punctuation">;</span>
     <span class="token punctuation">}</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span><span class="token punctuation">;</span>
 <span class="token keyword">bool</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>Возвращаемое значение:</p> <ul><li>При удаче возвращает NB_SUCCESS и заполняет структуру NBValue, на которую указывает указатель name.</li> <li>При неудаче возвращает код ошибки.</li></ul> <h2 id="nb-field-type"><a href="#nb-field-type" aria-hidden="true" class="header-anchor">#</a> nb_field_type</h2> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token class-name">NB_DATA_TYPE</span> nb_field_type <span class="token punctuation">(</span> <span class="token class-name">NB_HANDLE</span> connection<span class="token punctuation">,</span> <span class="token keyword">int</span> fieldnum <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Возвращает тип поля в записи, полученной последним вызовом nb_fetch_row.</p> <p>Параметры</p> <ul><li>connection — дескриптор соединения с сервером</li> <li>fieldnum — номер поля, начиная с 0</li></ul> <p>Возвращаемое значение — одно из следующих:</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">enum</span> NB_DATA_TYPE <span class="token punctuation">{</span>
 NB_DATA_NONE<span class="token punctuation">,</span>
 NB_DATA_STRING<span class="token punctuation">,</span>
 NB_DATA_INT<span class="token punctuation">,</span>
 NB_DATA_INT64<span class="token punctuation">,</span>
 NB_DATA_DOUBLE<span class="token punctuation">,</span>
 NB_DATA_DATETIME<span class="token punctuation">,</span>
 NB_DATA_BOOL<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>Значение NB_DATA_NONE возвращается в случае ошибки.</p> <h2 id="nb-field-value"><a href="#nb-field-value" aria-hidden="true" class="header-anchor">#</a> nb_field_value</h2> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token class-name">NB_ERROR_T</span> nb_field_value <span class="token punctuation">(</span>
    <span class="token class-name">NB_HANDLE</span> connection<span class="token punctuation">,</span>
    <span class="token keyword">int</span> fieldnum<span class="token punctuation">,</span>
    NBValue <span class="token operator">*</span> v <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Возвращает значение поля в записи, полученной последним вызовом nb_fetch_row.</p> <p>Параметры</p> <ul><li>connection — дескриптор соединения с сервером</li> <li>fieldnum — номер поля, начиная с 0</li> <li>v — указатель на структуру NBValue, в которую будет передан результат (см. описание функции nb_field_name)</li></ul> <p>Возвращаемое значение:</p> <ul><li>При удаче возвращает NB_SUCCESS и заполняет структуру NBValue, на которую указывает указатель v.</li> <li>При неудаче возвращает код ошибки.</li></ul> <h2 id="создание-кnиентского-приnожения"><a href="#создание-кnиентского-приnожения" aria-hidden="true" class="header-anchor">#</a> Создание клиентского приложения</h2> <p>При создании собственного приложения в Microsoft Visual Studio следует настроить каталоги библиотек и заголовочных файлов:</p> <ul><li>каталог nitrosbase/include необходимо добавить в список каталогов заголовочных файлов (Свойства проекта / каталоги VC++ / каталоги включения)</li> <li>каталоги nitrosbase/lib и nitrosbase/bin необходимо добавить в список каталогов библиотек (Свойства проекта / каталоги VC++ / каталоги библиотек)</li></ul> <p>Возможны два варианта компоновки с клиентской библиотекой:</p> <ul><li>использование препроцессора  #pragma comment(lib, &quot;nbclient.lib&quot;)</li> <li>добавление библиотеки nbclient.lib в список дополнительных библиотек   (для MS Visual Studio: Свойства проекта / компоновщик / ввод / дополнительные зависимости)</li></ul></div> <!----> <!----> </div></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.baeb26dc.js" defer></script><script src="/assets/js/2.8e020b7e.js" defer></script><script src="/assets/js/9.5eb39887.js" defer></script>
  </body>
</html>
