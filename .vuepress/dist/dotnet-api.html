<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>.NET API | NitrosBase</title>
    <meta name="description" content="">
    
    
    <link rel="preload" href="/assets/css/0.styles.154cb869.css" as="style"><link rel="preload" href="/assets/js/app.baeb26dc.js" as="script"><link rel="preload" href="/assets/js/2.8e020b7e.js" as="script"><link rel="preload" href="/assets/js/10.e1943148.js" as="script"><link rel="prefetch" href="/assets/js/11.e73b5ac5.js"><link rel="prefetch" href="/assets/js/12.7bfa7f61.js"><link rel="prefetch" href="/assets/js/13.3a9eb135.js"><link rel="prefetch" href="/assets/js/14.eebeb3e5.js"><link rel="prefetch" href="/assets/js/15.05524356.js"><link rel="prefetch" href="/assets/js/16.e24545f3.js"><link rel="prefetch" href="/assets/js/17.19d25572.js"><link rel="prefetch" href="/assets/js/18.6991e38c.js"><link rel="prefetch" href="/assets/js/3.9e4cd4b4.js"><link rel="prefetch" href="/assets/js/4.dd0e05cf.js"><link rel="prefetch" href="/assets/js/5.8899250e.js"><link rel="prefetch" href="/assets/js/6.b6c99375.js"><link rel="prefetch" href="/assets/js/7.348434a9.js"><link rel="prefetch" href="/assets/js/8.f8ee1f78.js"><link rel="prefetch" href="/assets/js/9.5eb39887.js">
    <link rel="stylesheet" href="/assets/css/0.styles.154cb869.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">NitrosBase</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><!---->  <ul class="sidebar-links"><li><a href="/" class="sidebar-link">NitrosBase 2.0</a></li><li><a href="/ustanovka-i-administrirovanie.html" class="sidebar-link">Установка и администрирование</a></li><li><a href="/demonstracionnaya-baza-dannykh.html" class="sidebar-link">Демонстрационная база данных</a></li><li><a href="/multimodelnost.html" class="sidebar-link">Мультимодельность</a></li><li><a href="/sql.html" class="sidebar-link">SQL</a></li><li><a href="/graph-it.html" class="sidebar-link">Graph-IT</a></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading open"><span>API</span> <span class="arrow down"></span></p> <ul class="sidebar-group-items"><li><a href="/c-api.html" class="sidebar-link">Native C/C++ API</a></li><li><a href="/dotnet-api.html" class="active sidebar-link">.NET API</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/dotnet-api.html#ado-net" class="sidebar-link">ADO.NET</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/dotnet-api.html#idbconnection-nitrosbaseconnection" class="sidebar-link">IDbConnection: NitrosBaseConnection</a></li><li class="sidebar-sub-header"><a href="/dotnet-api.html#idbtransaction-nitrosbasetransaction" class="sidebar-link">IDbTransaction: NitrosBaseTransaction</a></li><li class="sidebar-sub-header"><a href="/dotnet-api.html#idbcommand-nitrosbasecommand" class="sidebar-link">IDbCommand: NitrosBaseCommand</a></li><li class="sidebar-sub-header"><a href="/dotnet-api.html#idatareader-nitrosbasedatareader" class="sidebar-link">IDataReader: NitrosBaseDataReader</a></li><li class="sidebar-sub-header"><a href="/dotnet-api.html#idbdataparameter-nitrosbasedataparameter" class="sidebar-link">IDbDataParameter: NitrosBaseDataParameter</a></li><li class="sidebar-sub-header"><a href="/dotnet-api.html#idataparametercollection-nitrosbasedataparametercollection" class="sidebar-link">IDataParameterCollection: NitrosBaseDataParameterCollection</a></li></ul></li><li class="sidebar-sub-header"><a href="/dotnet-api.html#драйвер-ssrs" class="sidebar-link">Драйвер SSRS</a></li></ul></li><li><a href="/odbc.html" class="sidebar-link">ODBC</a></li></ul></div></li><li><a href="/log.html" class="sidebar-link">Версии</a></li></ul> </div> <div class="page"> <div class="content default"><h1 id="net-api"><a href="#net-api" aria-hidden="true" class="header-anchor">#</a> .NET API</h1> <h2 id="ado-net"><a href="#ado-net" aria-hidden="true" class="header-anchor">#</a> ADO.NET</h2> <p>Подключение к СУБД NitrosBase из C# производится через драйвер ADO.Net с названием Nitros.Net. Он включает в себя две библиотеки: Nitros.Net.Win.dll и nbclient.dll, и реализует подмножество интерфейсов, стандартных для ADO.Net:</p> <ul><li>IDbConnection</li> <li>IDbTransaction</li> <li>IDbCommand</li> <li>IDataReader</li> <li>IDbDataParameter</li> <li>IDataParameterCollection</li></ul> <h3 id="idbconnection-nitrosbaseconnection"><a href="#idbconnection-nitrosbaseconnection" aria-hidden="true" class="header-anchor">#</a> IDbConnection: NitrosBaseConnection</h3> <p>Интерфейс IDbConnection реализован в классе NitrosBaseConnection.</p> <p>Формат строки соединения (connection string):</p> <p>data source='dbserver';initial catalog='dbname'; userid='username';password='password';</p> <p>Справка по свойствам и методам интерфейса приведена в <a href="https://docs.microsoft.com/en-us/dotnet/api/system.data.idbconnection?view=netframework-4.7.2" target="_blank" rel="noopener noreferrer">документации Microsoft<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <h3 id="idbtransaction-nitrosbasetransaction"><a href="#idbtransaction-nitrosbasetransaction" aria-hidden="true" class="header-anchor">#</a> IDbTransaction: NitrosBaseTransaction</h3> <p>Интерфейс IDbTransaction реализован в классе NitrosBaseTransaction.</p> <p>Транзакции в СУБД NitrosBase в настоящее время не поддерживаются.</p> <p>Справка по свойствам и методам интерфейса приведена в <a href="https://docs.microsoft.com/en-us/dotnet/api/system.data.idbtransaction?view=netframework-4.7.2" target="_blank" rel="noopener noreferrer">документации Microsoft<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <h3 id="idbcommand-nitrosbasecommand"><a href="#idbcommand-nitrosbasecommand" aria-hidden="true" class="header-anchor">#</a> IDbCommand: NitrosBaseCommand</h3> <p>Интерфейс IDbCommand реализован в классе NitrosBaseCommand.</p> <ul><li>Метод ExecuteNonQuery всегда возвращает 0, поскольку СУБД не поддерживает получение числа измененных запросом строк.</li> <li>Метод Cancel ничего не делает, поскольку соответствующий метод отсутствует в API СУБД.</li> <li>Метод Prepare производит фактическую подстановку значений параметров в запрос на стороне клиента.</li></ul> <p>Справка по свойствам и методам интерфейса приведена в <a href="https://docs.microsoft.com/en-us/dotnet/api/system.data.idbcommand?view=netframework-4.7.2" target="_blank" rel="noopener noreferrer">документации Microsoft<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <h3 id="idatareader-nitrosbasedatareader"><a href="#idatareader-nitrosbasedatareader" aria-hidden="true" class="header-anchor">#</a> IDataReader: NitrosBaseDataReader</h3> <p>Интерфейс IDataReader реализован в классе NitrosBaseDataReader.</p> <p>Не поддерживаются (выбрасывают NotImplementedException) следующие методы:</p> <ul><li>GetBoolean</li> <li>GetByte</li> <li>GetBytes</li> <li>GetChars</li></ul> <p>Свойство RecordsAffected всегда возвращает -1, поскольку СУБД не поддерживает определение числа затронутых записей.</p> <p>Справка по свойствам и методам интерфейса приведена в <a href="https://docs.microsoft.com/en-us/dotnet/api/system.data.idatareader?view=netframework-4.7.2" target="_blank" rel="noopener noreferrer">документации Microsoft<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <h3 id="idbdataparameter-nitrosbasedataparameter"><a href="#idbdataparameter-nitrosbasedataparameter" aria-hidden="true" class="header-anchor">#</a> IDbDataParameter: NitrosBaseDataParameter</h3> <p>Интерфейс IDbDataParameter реализован в классе NitrosBaseDataParameter.</p> <p>Свойства Scale, Precision, Size, ParameterDirection не поддерживаются или поддерживаются частично:</p> <ul><li>Precision, Scale возвращают 0, при присвоении значения выбрасывают NotImplementedException.</li> <li>Size всегда выбрасывает NotImplementedException.</li> <li>ParameterDirection возвращает InputDirection, при присвоении значения выбрасывает NotImplementedException.</li></ul> <p>Справка по свойствам и методам интерфейса приведена в <a href="https://docs.microsoft.com/en-us/dotnet/api/system.data.idbdataparameter?view=netframework-4.7.2" target="_blank" rel="noopener noreferrer">документации Microsoft<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <h3 id="idataparametercollection-nitrosbasedataparametercollection"><a href="#idataparametercollection-nitrosbasedataparametercollection" aria-hidden="true" class="header-anchor">#</a> IDataParameterCollection: NitrosBaseDataParameterCollection</h3> <p>IDataParameterCollection реализован в NitrosBaseDataParameterCollection.Справка по свойствам и методам интерфейса приведена в <a href="https://docs.microsoft.com/en-us/dotnet/api/system.data.idataparametercollection?view=netframework-4.7.2" target="_blank" rel="noopener noreferrer">документации Microsoft<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <h2 id="драйвер-ssrs"><a href="#драйвер-ssrs" aria-hidden="true" class="header-anchor">#</a> Драйвер SSRS</h2> <p>Драйвер Microsoft Reporting Services позволяет строить отчеты на основе данных, хранящихся в NitrosBase. Регистрация драйвера описана <a href="https://docs.microsoft.com/en-us/sql/reporting-services/report-data/register-a-standard-net-framework-data-provider-ssrs?view=sql-server-2017" target="_blank" rel="noopener noreferrer">на сайте Microsoft<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <p>При регистрации в RSReportDesigner.config:</p> <ul><li>для Visual Studio следует использовать 32-разрядную сборку (nbclient32.dll, Nitros.Net.Win.dll)</li> <li>обе библиотеки (nbclient32.dll, Nitros.Net.Win) нужно скопировать во все указанные в инструкции каталоги</li> <li>теги для RSReportDesigner.config:</li></ul> <p>&lt;Extension Name=&quot;NB&quot;<br>
Type=&quot;NitrosData.Nitros.Net.NitrosBaseConnectionReporting,Nitros.Net.Win&quot;/&gt;&lt;Extension Name=&quot;NB&quot;<br>
Type=&quot;Microsoft.ReportingServices.QueryDesigners.SMQLQueryDesigner,<br>
Microsoft. ReportingServices.QueryDesigners.Extensions&quot;/&gt;</p></div> <!----> <!----> </div></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.baeb26dc.js" defer></script><script src="/assets/js/2.8e020b7e.js" defer></script><script src="/assets/js/10.e1943148.js" defer></script>
  </body>
</html>
